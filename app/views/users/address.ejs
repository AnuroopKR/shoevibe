 
<!--Website: wwww.codingdung.com-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shoevibe</title>
    <link rel="stylesheet" href="/style.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>

<body>
    <div class="container light-style flex-grow-1 container-p-y">
        <h4 class="font-weight-bold py-3 mb-4">
            Account settings
        </h4>
        <div class="card overflow-hidden">
            <div class="row no-gutters row-bordered row-border-light">
                <div class="col-md-3 pt-0">
                    <div class="list-group list-group-flush account-settings-links">
                        <a class="list-group-item list-group-item-action active" data-toggle="list"
                            href="#account-general">General</a>
                        <a class="list-group-item list-group-item-action" data-toggle="list"
                            href="#account-change-password">Change password</a>
                        <a class="list-group-item list-group-item-action" data-toggle="list"
                            href="#account-notifications">Notifications</a>
                        <a class="list-group-item list-group-item-action" 
                            href="#" data-toggle="modal" data-target="#myModal">Add address</a>
                            <a class="list-group-item list-group-item-action" data-toggle="list"
                            href="#addressload">address</a>
                            <a href="/logout" class="btn btn-danger">Logout</a>  
                    </div>
                    
                </div>
                <div class="col-md-9">
                    <div class="tab-content">
                        <div id="addressload" class="row tab-pane fade" style="display: flex;">
                            <%addressData.forEach(address=>{%>
                            <div class=" col-md-6 bg-warning">
                                <div class="card card-product-grid">
                                    <div class="card-body">
                                      <h5 class="card-title">Address</h5>
                                      
                                      <p class="card-text"><%=address.firstName%> <%address.lastName%></p>
                                      <p class="card-text"><%= address.address %></p>
                                      <p class="card-text"><%= address.landMark %></p>
                                      <p class="card-text"><%= address.city %></p>
                                      <p class="card-text"><%= address.state %></p>
                                      <p class="card-text"> pin :  <%= address.pin %></p>
                                     
                                      
                                      <a href="#" class="btn btn-info" role="button">set default</a>
                                      <a href="#" data-toggle="modal" data-target="#myModal-2" class="btn btn-info ml-5" role="button">edit</a>
                                      <a href="#" class="btn btn-info ml-5" role="button">delete</a>
                                      
                                    </div>
                                  </div>
                            </div>
                            <%})%>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      
    </div>

<!-- Bootstrap Modal -->
<div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Add address</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <div class="m-3">
                    <form class="row g-3" id="myForm">
                        <div class="col-md-6">
                            <label for="firstName" class="form-label">First Name</label>
                            <input type="text" class="form-control" name="firstName" id="firstName" onkeypress="checkEnter(event, 'lastName')">
                            <p id="firstNameError" style="color: red;"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="lastName" class="form-label">Last Name</label>
                            <input type="text" class="form-control" name="lastName" id="lastName" onkeypress="checkEnter(event, 'inputAddress')">
                            <p id="lastNameError" style="color: red;"></p>
                        </div>
                        <div class="col-12">
                            <label for="inputAdress" class="form-label">Address</label>
                            <input type="text" class="form-control" name="address" id="inputAddress" placeholder="1234 Main St" onkeypress="checkEnter(event, 'landmark')">
                            <p id="addressError" style="color: red;"></p>
                        </div>
                        <div class="col-12">
                            <label for="landmark" class="form-label">Landmark</label>
                            <input type="text" class="form-control" name="landmark" id="landmark" placeholder="Apartment, studio, or floor" onkeypress="checkEnter(event, 'inputCity')">
                            <p id="landmarkError" style="color: red;"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="inputCity" class="form-label">City</label>
                            <input type="text" class="form-control" name="city" id="inputCity" onkeypress="checkEnter(event, 'inputState')">
                            <p id="cityError" style="color: red;"></p>
                        </div>
                        <div class="col-md-4">
                            <label for="inputState" class="form-label">State</label>
                            <input type="text" class="form-control" name="state" id="inputState" onkeypress="checkEnter(event, 'pin')">
                            <p id="stateError" style="color: red;"></p>
                        </div>
                        <div class="col-md-2">
                            <label for="pin" class="form-label">Zip</label>
                            <input type="text" class="form-control" name="pin" id="pin" onkeypress="checkEnter(event, 'lastName')">
                            <p id="pinError" style="color: red;"></p>
                        </div>
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="gridCheck" >
                                <label class="form-check-label" for="gridCheck">
                                    Check me out
                                </label>
                            </div>
                        </div>
                        <div class="col-12">
                            <button type="button" class="btn btn-primary" onclick="submitForm()">Submit</button>
                        </div>
                    </form>
                    
                  </div>
            </div>
            <div id="result"></div>

            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>




<div class="modal" id="myModal-2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Add address</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <div class="m-3">
                    <form class="row g-3" id="myForm">
                        <div class="col-md-6">
                            <label for="firstName" class="form-label">First Name</label>
                            <input type="text" class="form-control" name="firstName" id="firstName" onkeypress="checkEnter(event, 'lastName')">
                            <p id="firstNameError" style="color: red;"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="lastName" class="form-label">Last Name</label>
                            <input type="text" class="form-control" name="lastName" id="lastName" onkeypress="checkEnter(event, 'inputAddress')">
                            <p id="lastNameError" style="color: red;"></p>
                        </div>
                        <div class="col-12">
                            <label for="inputAdress" class="form-label">Address</label>
                            <input type="text" class="form-control" name="address" id="inputAddress" placeholder="1234 Main St" onkeypress="checkEnter(event, 'landmark')">
                            <p id="addressError" style="color: red;"></p>
                        </div>
                        <div class="col-12">
                            <label for="landmark" class="form-label">Landmark</label>
                            <input type="text" class="form-control" name="landmark" id="landmark" placeholder="Apartment, studio, or floor" onkeypress="checkEnter(event, 'inputCity')">
                            <p id="landmarkError" style="color: red;"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="inputCity" class="form-label">City</label>
                            <input type="text" class="form-control" name="city" id="inputCity" onkeypress="checkEnter(event, 'inputState')">
                            <p id="cityError" style="color: red;"></p>
                        </div>
                        <div class="col-md-4">
                            <label for="inputState" class="form-label">State</label>
                            <input type="text" class="form-control" name="state" id="inputState" onkeypress="checkEnter(event, 'pin')">
                            <p id="stateError" style="color: red;"></p>
                        </div>
                        <div class="col-md-2">
                            <label for="pin" class="form-label">Zip</label>
                            <input type="text" class="form-control" name="pin" id="pin" onkeypress="checkEnter(event, 'lastName')">
                            <p id="pinError" style="color: red;"></p>
                        </div>
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="gridCheck" >
                                <label class="form-check-label" for="gridCheck">
                                    Check me out
                                </label>
                            </div>
                        </div>
                        <div class="col-12">
                            <button type="button" class="btn btn-primary" onclick="submitForm()">Submit</button>
                        </div>
                    </form>
                    
                  </div>
            </div>
            <div id="result"></div>

            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>

<!-- Bootstrap JS (popper.js and jquery are required dependencies) -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>

function validateForm() {
        // Get form data
        const currentPassword = document.getElementById("currentPassword").value;
        const newPassword = document.getElementById("newPassword").value;
        const repeatNewPassword = document.getElementById("repeatNewPassword").value;

        // Validate the form data
        // if (currentPassword === "" || newPassword === "" || repeatNewPassword === "") {
        //     alert("Please fill in all fields.");
        //     return false;
        // }

        var passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/;
        if (!passwordRegex.test(newPassword)||!passwordRegex.test(currentPassword)||!passwordRegex.test(repeatNewPassword)) {
            
            document.getElementById("passwordError").innerText = "Password must be at least 8 characters long and include at least one letter and one number.";
            return false; 
        }

        if (newPassword !== repeatNewPassword) {
            document.getElementById("passwordError").innerText = "Passwords do not match.";
            return false;
        } 
            else {
            document.getElementById("passwordError").innerText = "";
            return true;
        }
    };

    </script>






<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript"></script>

    <script>
       function submitForm() {
    // Get form data
    var formData = new FormData(document.getElementById('myForm'));

    // Convert FormData to a plain JavaScript object
    var formObject = {};
    formData.forEach((value, key) => {
        formObject[key] = value;
    });
    
   if( validateAddress()){ 

    // Make a POST request using Axios
    axios.post('/addAddress', formObject)
        .then(response => {
            // Handle the success response
            console.log(response.data);
            $('#myModal').modal('hide');
            // window.location.reload()
            console.log('Before load function');
            $('#addressload').load(location.href + ' #addressload', function() {
    console.log('After load function');
});


        })
        .catch(error => {
            // Handle the error response
            console.error(error);
        });
    } else {
            // If validation fails, do not proceed with form submission
            console.log('Form validation failed. Please correct the errors.');
        }
}
       




    function checkEnter(event, nextInputId) {
        if (event.key === 'Enter') {
            event.preventDefault();
            validateAddress();
            const nextInput = document.getElementById(nextInputId);
            if (nextInput) {
                nextInput.focus();
            }
        }
    }


     // Function to validate the form
     function validateAddress() {
        // Reset previous error messages
        document.getElementById('firstNameError').textContent = '';
        document.getElementById('lastNameError').textContent = '';
        document.getElementById('addressError').textContent = '';
        document.getElementById('landmarkError').textContent = '';
        document.getElementById('cityError').textContent = '';
        document.getElementById('stateError').textContent = '';
        document.getElementById('pinError').textContent = '';

        // Get form input values
        const firstName = document.getElementById('firstName').value.trim();
        const lastName = document.getElementById('lastName').value.trim();
        const address = document.getElementById('inputAddress').value.trim();
        const landmark = document.getElementById('landmark').value.trim();
        const city = document.getElementById('inputCity').value.trim();
        const state = document.getElementById('inputState').value.trim();
        const pin = document.getElementById('pin').value.trim();

        // Validate each input field
        if (!validateInput(firstName, 'First Name', 'firstNameError')) return false;
        if (!validateInput(lastName, 'Last Name', 'lastNameError')) return false;
        if (!validateInput(address, 'Address', 'addressError')) return false;
        if (!validateInput(landmark, 'Landmark', 'landmarkError')) return false;
        if (!validateInput(city, 'City', 'cityError')) return false;
        if (!validateInput(state, 'State', 'stateError')) return false;
        if (!validatePin(pin)) return false;

        // Additional validation logic can be added as needed

        // If all validations pass, return true
        return true;
    }

    // Function to validate individual input fields
    function validateInput(value, fieldName, errorId) {
        if (!value) {
            document.getElementById(errorId).textContent = `${fieldName} is required.`;
            return false;
        }
        return true;
    }

    function validatePin(pin) {
        if (!pin) {
            document.getElementById('pinError').textContent = 'PIN is required.';
            return false;
        }
        if (!/^\d{6}$/.test(pin)) {
            document.getElementById('pinError').textContent = 'PIN must be a 6-digit number.';
            return false;
        }
        return true;
    }


    </script>
    

</body>

</html>